package inputvalidation

import (
	"net/http"
	"strconv"
)

import "govwa/util"

func isNumeric(s string) bool {
	_, err := strconv.ParseInt(s, 10, 64)
	return err == nil
}
func WithValidation(r *http.Request) string {
	number := r.FormValue("number")
	min := 0
	max := 12
	if number == "" {
		return "Number should not be empty"
	} else if !isNumeric(number) {
		return "Number may contain string "
	} else if len(number) <= min || len(number) > max {
		return "Number out of range"
	} else {
		return number
	}
}

func WithNoValidation(r *http.Request) string {
	number := r.FormValue("number")
	min := 0
	max := 12
	if len(number) <= min || len(number) > max {
		return "Number out of range"
	}
	return number
}

//input validation
func validateHandler(w http.ResponseWriter, r *http.Request) {
	
		var data = WithNoValidation(r) //default
		if util.CheckLevel(r) {                   //if level == high
			data = WithValidation(r)
		}
		datares := make(map[string]interface{})
		datares["res"] = data
		//fmt.Println(checkLevel(r))
		util.SafeRender(w, "validation", datares)
	}